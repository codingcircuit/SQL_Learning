# 5. Transaction Control Language (TCL)

- Oracle server considers transactions for ensuring data consistency.
- A transaction is a set of one or more DML statements which Oracle treats as a single logical unit of work.
- A transaction groups SQL statements so that they are either all committed (applied to the database) or rolled back (undone from the database).
- All changes made by DML statements are made permanent and visible to other users only after committing the changes.
- DCL and DDL commands always force a commit and explicit committing is not required.

<br>  



## Transaction Start and End Scenarios

- A Transaction begins when the first executable SQL statement is encountered.
- The Transaction terminates when any of the following actions occur.
     - A COMMIT or ROLL BACK issued.
     - A DDL statement issued
     - A DCL statement issued
     - Normal shut down from database
     - Failure of machine or system crashes

## Explicit Transaction Control Statements
- COMMIT
- SAVEPOINT
- ROLLBACK

<br>  


#### COMMIT

- It ends the current Transaction by making all pending data changes permanent.
- Once committed, all users can view the recent changes.

<br>  


```sql
COMMIT;

```


<br>

> [!NOTE]
> When SQL for INSERT records in an interactive manner is executed, you will be prompted to enter the values for arguments.  
> Below are the provided values here
>   
> Enter value for DEPARTMENT_ID : 30  
> Enter value for DEPARTMENT_NAME : Purchasing  
> Enter value for MANAGER_ID : 114  
> Enter value for LOCATION_ID : 1700

 ```sql
rem old:
INSERT INTO department VALUES (&DEPARTMENT_ID, '&DEPARTMENT_NAME', &MANAGER_ID, &LOCATION_ID)
``` 
```sql
rem new:
INSERT INTO department VALUES (30, 'Purchasing', 114, 1700)
```

<br>  

<br>  


```sql
select * from department ;
```

![images/insert-table-data.png](https://github.com/venkatdurgempudi/SQL/blob/main/sql-basics/images/insert-table-data.png?raw=true)

<br>  



```sql          
select * from department_copy ;
```
![images/insert-table-data.png](https://github.com/venkatdurgempudi/SQL/blob/main/sql-basics/images/insert-table-data.png?raw=true)

<br>    


#### SAVEPOINT

- Update command is used to change or modify one or more record data in a table.
- When a WHERE condition is specified
    -  first, the records which satisfy the condition are filtered.
    -  then, updation is done only on those records which satisfy the condition.
- All rows will be updated if no condition is specified in where clause.

<br>  


```sql
rem UPDATE using WHERE clause
UPDATE department
SET DEPARTMENT_NAME = 'Single Row Update'
WHERE DEPARTMENT_ID = 10 ;

rem UPDATE without WHERE clause
UPDATE department_copy
SET DEPARTMENT_NAME = 'All Rows Update' ;
``` 


<br>  


```sql
select * from department ;
```

![images/update-table-data-with-where.png](https://github.com/venkatdurgempudi/SQL/blob/main/sql-basics/images/update-table-data-with-where.png?raw=true)

<br>  



```sql          
select * from department_copy ;
```
![images/update-table-data-without-where.png](https://github.com/venkatdurgempudi/SQL/blob/main/sql-basics/images/update-table-data-without-where.png?raw=true)

<br>    

<br>  


#### ROLLBACK

- Delete statement is used to remove records from a table.
- A subset may be defined for deletion using WHERE condition; otherwise all records will be removed.

```sql
rem DELETE with WHERE condition
DELETE FROM department
WHERE DEPARTMENT_NAME = 'Single Row Update' ;

rem DELETE without WHERE condition
DELETE FROM department_copy ;
```

<br>  
<br>  

```sql
select * from department ;
```

![images/delete-table-data-with-where.png](https://github.com/venkatdurgempudi/SQL/blob/main/sql-basics/images/delete-table-data-with-where.png?raw=true)

<br>  
<br> 



```sql          
select * from department_copy ;
```
![images/delete-table-data-without-where.png](https://github.com/venkatdurgempudi/SQL/blob/main/sql-basics/images/delete-table-data-without-where.png?raw=true)
   

> [!NOTE]
> Without WHERE condition all the records will be deleted in the table. 


<br>  


